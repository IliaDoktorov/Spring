--create table unit(
--    id int primary key generated by default as identity,
--    "name" varchar(30) not null,
--    parent_unit varchar(30)
--)

create table unit(
    "name" varchar(30) primary key,
    parent_unit varchar(30)
)

create table person(
    id int primary key generated by default as identity,
    first_name varchar(30) not null,
    last_name varchar(30) not null,
    email varchar(30) unique not null,
    is_active boolean,
    position int
)

create table unit_person(
    person_id int references person(id) on delete set null,
    unit_name varchar(30) references unit("name") on delete set null
)

create table position(
    id int primary key generated by default as identity,
    "name" varchar(30)
)

insert into position(name) values ('manager');

select * from position

truncate table position

select * from person
drop table person cascade
drop table unit_person
truncate table person cascade 


select * from unit_person
truncate table unit_person



drop table unit

select * from unit;

select p1_0.unit_name,p1_1.id,p1_1.email,p1_1.first_name,p1_1.is_active,p1_1.last_name,p2_0.id,p2_0.name from unit_person p1_0 join person p1_1 on p1_1.id=p1_0.person_id left join position p2_0 on p2_0.id=p1_1.position where p1_0.unit_name='four_unit'